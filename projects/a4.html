<!DOCTYPE HTML>
<!--
  Editorial by HTML5 UP
  html5up.net | @ajlkn
  Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Project 4: Machine Learning - ROB 102</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="../assets/css/main.css" />
    <link rel="shortcut icon" type="image/png" href="../images/mbot_overhead.png"/>

    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/stackoverflow-light.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/languages/julia.min.js"></script>

    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body class="is-preload">

    <!-- Wrapper -->
      <div id="wrapper">

        <!-- Main -->
          <div id="main">
            <div class="inner">

              <!-- Header -->
                <header id="header">
                  <a href="../index.html" class="logo"><strong>ROB 102:</strong> Introduction to AI and Programming</a>
                  <ul class="icons">
                    <li><a href="#" class="icon brands fa-slack"><span class="label">Slack</span></a></li>
                    <li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
                  </ul>
                </header>

              <!-- Content -->
                <section>
                  <header class="main project">
                    <strong>Project 4:</strong> Machine Learning for Image Classification
                  </header>

                  <p>In this project, we will use machine learning algorithms to perform <strong>image classification</strong>. Image classification is the task of predicting the class, or label, of an image out of a set of known images. For our purposes, machine learning refers to algorithms which can perform prediction by learning from labelled datasets.</p>

                  <p>We will be writing algorithms to do image classification on the <a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10</a> dataset. CIFAR-10 consists of tiny 32&#215;32 pixel images from 10 classes. The classes and a few example images from each are shown below.</p>

                  <span class="image main"><img src="../images/p4/cifar10.png" alt="" style="max-width:550px;"/></span>

                  <p>CIFAR-10 has 50,000 images to train a classification algorithm, each labelled with one of the classes shown above. In addition, there are 10,000 images which are used for testing the accuracy of the algorithm. We will implement three machine learning algorithms to classify images: <a href="#nearest_neighbor">nearest neighbors</a>, <a href="#linear_classifier">linear classification</a>, and a <a href="#neural_net">neural network</a>.</p>

                  <p>This project is implemented using the programming language <a href="https://julialang.org/">Julia</a>. Before you start, make sure you have followed the <a href="setup.html#install_julia">Julia install instructions</a> to install Julia locally on your computer. The following topics are covered on this page:</p>

                  <ul>
                    <li><a href="#getting_code">Getting the code</a></li>
                    <li><a href="#run_jupyter">Launching a Jupyter Notebook</a></li>
                    <li><a href="#proj_desc">Project description</a></li>
                    <li><a href="#tasks">Task Summary</a></li>
                    <li><a href="#adv_ext">Advanced Extensions</a></li>
                  </ul>

                  <hr class="major" />

                  <h2 id="getting_code">Getting the code</h2>

                  <p>You will create a Git repository to store your code based off the provided template, as in previous projects. Navigate to the template code <a href="https://github.com/rob102-staff/machine-learning">here</a> and create a repository using the template. Remember to <b>make sure it is set to private</b>. Storing your assignment solutions in a public repository is a violation of the honor code. Give Prof. Jenkins and Jana access to your code using their usernames, <code>ohseejay</code> and <code>janapavlasek</code>. Finally, clone your new repository on your computer, substituting the address to your repo:</p>
                  <pre><code class="language-bash">git clone &lt;ADDRESS&gt;</code></code></pre>
                  <p>If you need to refresh your memory, refer to the <a href="a0.html#getting_code">instructions from Project 0</a> for more details about this step.</p>

                  <hr class="major" />

                  <h2 id="run_jupyter">Launching a Jupyter Notebook</h2>

                  <p>We will use <em>Jupyter notebooks</em> to write code in Julia quickly and easily visualize outputs. To launch a Jupyter notebook which uses Julia, open a Julia interpreter and enter the following commands:</p>
                  <pre><code class="language-julia">using IJulia
notebook()</code></pre>
                  <p>A webpage should open on your default browser with the home page for the Jupyter notebook server you just launched. Navigate to the repository you just cloned for Project 4. The page will look something like this:</p>

                  <span class="image main"><img src="../images/p4/jupyter_server.png" alt="" style="max-width:800px;"/></span>

                  <p>To stop the Jupyter notebook server, do <code>Ctrl-C</code> (on Mac, do <code>Cmd-C</code>).</p>

                  <hr class="major" />

                  <h2 id="proj_desc">Project Description</h2>

                  <p>In this project, you will develop three algorithms for image classification on the CIFAR-10 dataset:</p>
                    <ul>
                      <li><a href="#nearest_neighbor">Part 1: Nearest Neighbors</a></li>
                      <li><a href="#linear_classifier">Part 2: Linear Classifier</a></li>
                      <li><a href="#neural_net">Part 3: Neural Network</a></li>
                    </ul>


                  <h3 id="nearest_neighbor">Part 1: Nearest Neighbors</h3>

                    <p>In Part 1 of this project, you will implement a Nearest Neighbor classifier. The nearest neighbor algorithm takes a test image and finds the <em>closest</em> train image, which we call the image's nearest neighbor. Then, it assigns the test image the same label as its nearest neighbor. Here is an example of some CIFAR-10 images and their nearest neighbors:</p>

                    <span class="image main"><img src="../images/p4/nearest_neighbor.png" alt="" style="max-width:600px;"/></span>

                    <h4>Notebook setup</h4>

                    <p>Open the notebook <code>nearest_neighbors.ipynb</code> by double-clicking it in the web browser. The notebook is made up of <em>cells</em>, which can be text cells (in Markdown) or code cells (in Julia). You can run a cell by selecting the cell and pressing &nbsp;<i class="fas fa-play"></i>&nbsp;<b>Run</b>.</p>

                    <span class="image main"><img src="../images/p4/run_cell.png" alt=""/></span>

                    <p>You need to run a cell before you use anything it defines in another cell. For example, you should always run the imports cell when you start the notebook. Similarly, you must run a cell which defines a variable or function before running a cell that uses it. Start by running the import cell at the top of the notebook <code>nearest_neighbors.ipynb</code> to import some dependencies we'll need later on.</p>

                    <h4>The CIFAR-10 data</h4>

                    <p>The second cell in the notebook loads the CIFAR-10 data, provided by the &quot;MLDatasets&quot; Julia library. Run this cell now. The first time you load the data, you'll see a message like this:</p>

                    <span class="image main"><img src="../images/p4/download_cifar.png" alt="" style="max-width:800px;"/></span>

                    <p>Type <code>y</code> into the box that appears at the top and press enter to download the data in
                    the default directory. It will take a few minutes for the data to download.</p>

                    <p>Let's take a look at how the image data is represented. This code loads the CIFAR-10 data:</p>
                    <pre><code class="language-julia">x_train, y_train = CIFAR10.traindata(Float32, train_idx)
x_test,  y_test  = CIFAR10.testdata(Float32, test_idx)</code></pre>

                    <p>
                      The variable <code>x_train</code> holds the training images, and <code>x_test</code> holds the testing images. Each image has size <code>(32,&nbsp;32,&nbsp;3)</code>. There are <code>N_train</code> training images, and <code>N_test</code> testing images, so the variables <code>x_train</code> and <code>x_test</code> are size <code>(N_train,&nbsp;32,&nbsp;32,&nbsp;3)</code> and <code>(N_test,&nbsp;32,&nbsp;32,&nbsp;3)</code> respectively. Each pixel value is a float between 0 and 1.
                      The variables <code>y_train</code> and <code>y_test</code> contain integers corresponding to the labels for each of the images. For example, the label 1 corresponds to &quot;airplane&quot;, 2 corresponds to &quot;automobile&quot;, etc. <code>y_train</code> and <code>y_test</code> are vectors of length <code>N_train</code> and <code>N_test</code> respectively.
                    </p>

                    <p>The data loading code does some processing on the data to prepare it for use in this assignment. Notably, it flattens the image data into vectors of length <code>32&#215;32&#215;3&nbsp;=&nbsp;3072</code>. The images which we will use in this project are stored in matrices, <code>x_train</code> and <code>x_test</code>, with the data for each image stored in one row of the matrix.</p>

                    <ul class="hint">
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> The following Julia code would get the vector of image data and the label for that image for the training image at index <code>i</code>:
                        <pre><code class="language-julia">img = x_train[i, :]
label = y_train[i]</code></pre>
                      </li>
                    </ul>

                    <h4>Computing distance between images</h4>

                    <p>The nearest neighbors algorithm requires a measure of <em>distance</em> between two images. We will use the \(n\)-dimensional Euclidean distance. Given two vectors of length \(n\), \(\textbf{u}\) and \(\textbf{v}\), the Euclidean distance between them is:</p>

                    <p>$$
                      d(\textbf{u}, \textbf{v}) = \sqrt{(u_1 - v_1)^2 + (u_2 - v_2)^2 + \dots + (u_n - v_n)^2}
                    $$</p>

                    <p>The function <code>compute_distance()</code> in the provided notebook should compute the distance between two image vectors.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_1_1">4.1.1:</strong> Complete the function <code>compute_distance()</code> so that it returns the distance between two flattened images.
                      </li>
                    </ul>

                    <p>To find the nearest neighbors of a test image, we need to find the distances between the image and every image in the training set of images. The function <code>compute_distances()</code> should find the distance between a test image and each of the training images. Use the provided test cells to check that your functions are working correctly.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_1_2">4.1.2:</strong> Complete the function <code>compute_distances()</code> so that it returns a vector containing the distance from a test image to each training image.
                      </li>
                    </ul>

                    <ul class="hint">
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> You should reuse <code>compute_distance()</code> when implementing the <code>compute_distances()</code> function.
                      </li>
                    </ul>

                    <h4>Finding nearest neighbors</h4>

                    <p>We want to find the nearest neighbor of a test image in the training set. The nearest neighbor of an image is the image with the <em>smallest</em> distance. The function <code>nearest_neighbor()</code> should find the index of the nearest training image to a given test image.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_1_3">4.1.3:</strong> Complete the function <code>nearest_neighbor()</code> so that it returns an integer corresponding to the index of the nearest neighbor to a test image in the training set.
                      </li>
                    </ul>

                    <ul class="hint">
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> You should reuse <code>compute_distances()</code> when implementing the <code>nearest_neighbor()</code> function.
                      </li>
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> Why do we want the index of the nearest neighbor instead of the image itself? Think of the index as a unique ID for a data point. We can use the index to access the image or its label. We'll see why this is useful later.
                      </li>
                    </ul>

                    <p>We need to classify all <code>N_test</code> images in the test set. The function <code>nearest_neighbors_multi()</code> should return a vector of indices corresponding to the nearest training image for each test image. Again, the notebook contains test cells to help you check that your functions are implemented correctly.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_1_4">4.1.4:</strong> Complete the function <code>nearest_neighbors_multi()</code> so that it returns a vector of integers corresponding to the indices of the nearest neighbor to each test image in the training set.
                      </li>
                    </ul>

                    <ul class="hint">
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> You should reuse <code>nearest_neighbor()</code> when implementing the <code>nearest_neighbors_multi()</code> function.
                      </li>
                    </ul>

                    <p>Now, we have the functions we need to implement a Nearest Neighbors image classifier. The function <code>predict_nn_labels()</code> should use the training data <code>x_train</code> and <code>y_train</code> to predict the labels for each test image in <code>x_test</code>.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_1_5">4.1.5:</strong> Complete the function <code>predict_nn_labels()</code> so that it returns a vector of integers corresponding to the class labels for each test image.
                      </li>
                    </ul>

                    <ul class="hint">
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> You might consider using <code>nearest_neighbors_multi()</code> when implementing the <code>predict_nn_labels()</code> function.
                      </li>
                    </ul>

                    <p>Congratulations! You just implemented a machine learning algorithm for image classification. Use the provided cell to check the accuracy of your algorithm. How did you do? What happens to the accuracy when you change the number of training images, <code>N_train</code>? (Remember to rerun the necessary cells when you change the values).</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_1_6">4.1.6:</strong> Change the value of <code>N_train</code> and rerun the prediction step. The value should be between 1 and 50,000. Record your observations.
                      </li>
                    </ul>

                    <ul class="hint">
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> How do different values of <code>N_train</code> affect the prediction accuracy? The computation time?
                      </li>
                      <li class="icon solid fa-cogs">
                        <strong>Hint:</strong> For very large values of <code>N_train</code>, you might run out of time (or even memory). Use your reason when deciding which values to try. You will not have time to try them all!
                      </li>
                    </ul>

                    <h4><em>Advanced Extension:</em> k-Nearest Neighbors</h4>

                    <p>In k-nearest neighbors, we try to improve our prediction by finding the \(k\) nearest neighbors to a test image. We perform prediction by letting the neighbors vote on the label for the test image. As an advanced extension, you may complete the k-nearest neighbors algorithm using the template code in the notebook.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todoAE_4i">Advanced Extension 4.i:</strong> Implement k-nearest neighbors in the provided notebook cells.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong id="todoAE_4ii">Advanced Extension 4.ii:</strong> Experiment with different values of \(k\) and report how \(k\) affects the accuracy. Select a value of \(k\) and compare the accuracy to that of nearest neighbors.
                      </li>
                    </ul>

                  <h3 id="linear_classifier">Part 2: Linear Classifier</h3>

                    <p>Let's see if we can do a bit better at classifying images by <em>learning</em> the parameters for a linear function.</p>

                    <h4>Forward Pass</h4>

                    <p>Given a set of weights, the <em>forward pass</em> of the classifier should return the scores for each class, for a given image.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_2_1">4.2.1:</strong> Complete the function <code>linear_forward()</code> so that it returns the class score for each image.
                      </li>
                    </ul>

                    <h4>Backward Pass</h4>

                    <p>The gradient computation is given. You will implement the hinge loss.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_2_2">4.2.2:</strong> Complete the function <code>svm_loss()</code> to calculate the hinge loss given the class scores.
                      </li>
                    </ul>

                    <h4>Training the network</h4>

                    <p>Now, we will use the functions we developed to train a linear classifier.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_2_3">4.2.3:</strong> Complete the function <code>train_svm()</code> to train the linear classifier.
                      </li>
                    </ul>

                    <h4>Testing the network</h4>

                    <p>Once we have found a set of weights, we can use them to test our algorithm. Code has been provided to test the accuracy of the network.</p>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_2_4">4.2.4:</strong> Complete the function <code>test_svm()</code> to use the forward pass function to predict a label for each image.
                      </li>
                    </ul>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong id="todo4_2_5">4.2.5:</strong> Tune the learning rate and the regularization constant. See how high you can get your accuracy.
                      </li>
                    </ul>

                  <h3 id="neural_net">Part 3: Neural Network</h3>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis dapibus rutrum facilisis. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Etiam tristique libero eu nibh porttitor fermentum. Nullam venenatis erat id vehicula viverra. Nunc ultrices eros ut ultricies condimentum. Mauris risus lacus, blandit sit amet venenatis non, bibendum vitae dolor. Nunc lorem mauris, fringilla in aliquam at, euismod in lectus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. In non lorem sit amet elit placerat maximus. Pellentesque aliquam maximus risus, vel sed vehicula.</p>
                    <p>Interdum et malesuada fames ac ante ipsum primis in faucibus. Pellentesque venenatis dolor imperdiet dolor mattis sagittis. Praesent rutrum sem diam, vitae egestas enim auctor sit amet. Pellentesque leo mauris, consectetur id ipsum sit amet, fersapien risus, commodo eget turpis at, elementum convallis elit. Pellentesque enim turpis, hendrerit tristique lorem ipsum dolor.</p>

                  <hr class="major" />

                  <h2 id="tasks">Task Summary</h2>

                  <h3>Part 1: Nearest Neighbors</h3>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_1_1">4.1.1</a>:</strong> Complete the function <code>compute_distance()</code> so that it returns the distance between two images.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_1_2">4.1.2</a>:</strong> Complete the function <code>compute_distances()</code> so that it returns a vector of distances between an image and a matrix of training images.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_1_3">4.1.3</a>:</strong> Complete the function <code>nearest_neighbor()</code> so that it returns the index of the nearest neighbor to a test image in the training set.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_1_4">4.1.4</a>:</strong> Complete the function <code>nearest_neighbors_multi()</code> so that it returns a vector of indices of the nearest neighbors of each test image in the training set.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_1_5">4.1.5</a>:</strong> Complete the function <code>predict_nn_labels()</code> to predict labels for a set of test images using nearest neighbors.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_1_6">4.1.6</a>:</strong> Experiment with the value of <code>N_train</code> and record your observations.
                      </li>
                    </ul>

                    <h3>Part 2: Linear Classifier</h3>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_2_1">4.2.1</a>:</strong> Complete the function <code>linear_forward()</code> so that it returns the class score for each image.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_2_2">4.2.2</a>:</strong> Complete the function <code>svm_loss()</code> to calculate the hinge loss given the class scores.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_2_3">4.2.3</a>:</strong> Complete the function <code>train_svm()</code> to train the linear classifier.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_2_4">4.2.4</a>:</strong> Complete the function <code>test_svm()</code> to use the forward pass function to predict a label for each image.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todo4_2_5">4.2.5</a>:</strong> Tune the learning rate and the regularization constant. See how high you can get your accuracy.
                      </li>
                    </ul>

                    <h3>Part 3: Neural Network</h3>

                  <hr class="major" />

                  <h2 id="adv_ext">Advanced Extensions</h2>

                    <ul class="todo">
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todoAE_4i">Advanced Extension 4.i</a>:</strong> Implement the k-nearest neighbors algorithm.
                      </li>
                      <li class="icon solid fa-laptop-code">
                        <strong><a href="#todoAE_4ii">Advanced Extension 4.ii</a>:</strong> Experiment with different values of \(k\).
                      </li>
                    </ul>

                </section>

            </div>
          </div>

        <!-- Sidebar -->
          <div id="sidebar">
            <div class="inner">

              <!-- Menu -->
                <nav id="menu">
                  <header class="major">
                    <h2>Menu</h2>
                  </header>
                  <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li>
                      <span class="opener">Course Information</span>
                      <ul>
                        <li><a href="../index.html#sec_syllabus">Syllabus</a></li>
                        <li><a href="../index.html#sec_schedule">Schedule</a></li>
                        <li><a href="../index.html#sec_course_staff">Course Staff</a></li>
                        <li><a href="../index.html#sec_policies">Course Policies</a></li>
                      </ul>
                    </li>
                    <li>
                      <span class="opener active">Projects</span>
                      <ul>
                        <li><a href="a0.html">Project 0: Intro to C++</a></li>
                        <li><a href="a1.html">Project 1: Wall Following</a></li>
                        <li><a href="a2.html">Project 2: Potential Field Control</a></li>
                        <li><a href="a3.html">Project 3: Path Planning</a></li>
                        <li><a href="a4.html">Project 4: Machine Learning</a></li>
                      </ul>
                    </li>
                    <li>
                      <span class="opener">Tutorials</span>
                      <ul>
                        <li><a href="../tutorials/setup.html">Computer Setup</a></li>
                        <li><a href="../tutorials/git.html">Github</a></li>
                        <li><a href="../tutorials/robot.html">Using the MBot-Omni</a></li>
                        <li><a href="../tutorials/app.html">Using the Webapp</a></li>
                      </ul>
                    </li>
                  </ul>
                </nav>

              <!-- Section -->
                <section>
                  <header class="major">
                    <h2>Course Times</h2>
                  </header>
                  <p>Lectures, labs and office hours.</p>
                  <ul class="contact">
                    <li class="icon solid fa-chalkboard-teacher">MW 10-11:30 AM @ GFL 107</li>
                    <li class="icon solid fa-vials">F 12-2 PM (002) @ FRB 1060 <br/>F 2-4 PM (003)  @ FRB 1060</li>
                    <li class="icon solid fa-users">TBD</li>
                  </ul>
                </section>

              <!-- Footer -->
                <!-- <footer id="footer">
                  <p class="copyright">&copy; Untitled. All rights reserved. Demo Images: <a href="https://unsplash.com">Unsplash</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
                </footer> -->

            </div>
          </div>

      </div>

    <!-- Scripts -->
      <script src="../assets/js/jquery.min.js"></script>
      <script src="../assets/js/browser.min.js"></script>
      <script src="../assets/js/breakpoints.min.js"></script>
      <script src="../assets/js/util.js"></script>
      <script src="../assets/js/main.js"></script>
      <script>hljs.highlightAll();</script>

  </body>
</html>
